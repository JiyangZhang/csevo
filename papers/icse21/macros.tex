%%% macros.tex
%%% Import packages, define utility commands and define macros
%%% Version 1.2.0

%%%----------
%%% Imports

%%% Text Formatting
\usepackage{xspace}
\usepackage{xcolor}
\usepackage{graphicx}
\usepackage[normalem]{ulem} % normalem do not replace \emph to underline
\usepackage{enumitem}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}

%%% Reference, Citation and Link
\usepackage[linkcolor=black,citecolor=black,anchorcolor=black,filecolor=black,menucolor=black,runcolor=black,urlcolor=black,hidelinks]{hyperref}
%\usepackage{url}
\usepackage{breakurl}
\usepackage{cite}

%%% Tables
\usepackage{booktabs}
\usepackage{multirow}
\usepackage{makecell}
\usepackage{ragged2e}

%%% Plots
%\usepackage{caption}
\usepackage{subcaption}
%\usepackage{subfloat}
%\usepackage{wrapfig}

% Code
\usepackage{listings}

% Tikz Figs
\usepackage{tikz}
%\usepackage{pgf-umlsd} % for flow diagram
\usetikzlibrary{calc}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{decorations.pathreplacing}
\usetikzlibrary{positioning}
\usetikzlibrary{patterns}
%\usetikzlibrary{shapes}

%%% Miscellaneous
\usepackage{flushend} % balance the end of double column document
\usepackage{datetime}

%%%----------
%%% Utility Commands

\newcommand{\XSpace}[1]{}
\newcommand{\XComment}[1]{}
\newcommand{\Fix}[1]{\textcolor{red}{#1}}
\newcommand{\JiyangComment}[1]{\textcolor{purple}{\bf\small [#1 --JZ]}}
%% \newcommand{\Fix}[1]{}
%% \newcommand{\JiyangComment}[1]{}
\newcommand{\EditAdd}[1]{\textcolor{green}{[#1]}}
\newcommand{\EditRm}[1]{\textcolor{red}{[\sout{#1}]}}
\newcommand{\EditMod}[2]{\textcolor{red}{[\sout{#1}]}\textcolor{green}{[#2]}}
\newcommand{\DefMacro}[2]{\expandafter\newcommand\csname rmk-#1\endcsname{#2}}
\newcommand{\UseMacro}[1]{\csname rmk-#1\endcsname}

\newcommand{\MyPara}[1]{\noindent\textbf{#1}.}
\newcommand{\MyParaOnly}[1]{\noindent\textbf{#1}}
\newcommand{\reducedstrut}{\vrule width 0pt height .9\ht\strutbox depth .9\dp\strutbox\relax}
\newcommand{\InputWithSpace}[1]{\bgroup\def\arraystretch{1.1}\input{#1}\egroup}
\newcommand{\Code}[1]{{\ifmmode{\mathtt{#1}}\else$\mathtt{#1}$\fi}}
\newcommand{\CodeIn}[1]{{\ifmmode{\mathtt{#1}}\else$\mathtt{#1}$\fi}}
\newcommand{\ColorBack}[1]{%
  \begingroup
  \setlength{\fboxsep}{0pt}%
  \colorbox{purple!20}{\reducedstrut#1\/}%
  \endgroup
}

% for table headers
\newcommand{\specialcell}[2][c]{%
  \begin{tabular}[#1]{@{}c@{}}#2\end{tabular}}
\newcolumntype{R}[1]{>{\RaggedLeft\arraybackslash}p{#1}}
\newcolumntype{L}[1]{>{\RaggedRight\arraybackslash}p{#1}}

% for including revision info in the document
\newcommand{\RevisionInfo}{\textcolor{red}{Time: \today{} at \currenttime{.}}}

% Roman numbers
\makeatletter
\newcommand*{\Rom}[1]{\expandafter\@slowromancap\romannumeral #1@}
\makeatother

\input{code/defs-logic} % for logic symbols
\input{code/defs-code} % for code listings


%%%----------
%%% Macros

%%% Text

%% \newcommand{\XXTool}{\textsc{XX}\xspace}
%\newcommand{\Title}{Evolution-Aware Code Summarization}
%\newcommand{\Title}{Inflated Automatic Metrics In Code Summarization Tasks}
%\newcommand{\Title}{An Empirical Study On Evolution-aware, Cross-project, and Mixed-project Dataset Splits In Code Summarization Tasks}
%\newcommand{\Title}{An Empirical Study On Evolution-aware, Cross-project, and Mixed-project Methodologies For Evaluating Code Summarization Tasks}
%\newcommand{\Title}{An Empirical Study On Mixed-project, Cross-project, and Evolution-aware Methodologies For Evaluating Code Summarization Tasks}
%% \newcommand{\Title}{An Empirical Study on Evaluation Methodologies for Code Summarization Tasks}
\newcommand{\Title}{An Empirical Study on Evaluation Methodologies for Code Learning Tasks}

\newcommand{\mixedproj}{mixed-project\xspace}
\newcommand{\Mixedproj}{Mixed-project\xspace}
\newcommand{\crossproj}{cross-project\xspace}
\newcommand{\Crossproj}{Cross-project\xspace}
\newcommand{\evoaware}{temporally-segmented\xspace}
\newcommand{\Evoaware}{Temporally-segmented\xspace}
\newcommand{\example}{example\xspace}
\newcommand{\examples}{examples\xspace}

%\newcommand{\lowercase}{lower case\xspace}
%\newcommand{\Firstcap}{First cap\xspace}
%\newcommand{\CamelCase}{Camel Case\xspace}
\newcommand{\Csharp}{{\settoheight{\dimen0}{C}C\kern-.05em \resizebox{!}{\dimen0}{\raisebox{\depth}{\#}}}\xspace}
\newcommand{\ctl}{code to language\xspace}
\newcommand{\comgen}{comment generation\xspace}
\newcommand{\ComGen}{Comment Generation\xspace}
\newcommand{\methnam}{method naming\xspace}
\newcommand{\MethNam}{Method Naming\xspace}
\newcommand{\common}{common\xspace}
\newcommand{\Common}{Common\xspace}
\newcommand{\dataset}{dataset\xspace}
\newcommand{\DataSet}{Dataset\xspace}
\newcommand{\datasets}{datasets\xspace}
\newcommand{\DataSets}{Datasets\xspace}
\newcommand{\evo}{evolution\xspace}
\newcommand{\Evo}{Evolution\xspace}
\newcommand{\filterfunc}{filtering function\xspace}
\newcommand{\javadoc}{JavaDoc\xspace}
\newcommand{\lat}{latest\xspace}
\newcommand{\Lat}{Latest\xspace}
\newcommand{\namegen}{name generation\xspace}
\newcommand{\repo}{repository\xspace}
\newcommand{\Repo}{Repository\xspace}
\newcommand{\repos}{repositories\xspace}
\newcommand{\Repos}{Repositories\xspace}
\newcommand{\standard}{standard\xspace}
\newcommand{\Standard}{Standard\xspace}
\newcommand{\sts}{seq2seq\xspace}
\newcommand{\test}{testing\xspace}
\newcommand{\Test}{Testing\xspace}
\newcommand{\train}{training\xspace}
\newcommand{\Train}{Training\xspace}
\newcommand{\val}{validation\xspace}
\newcommand{\Val}{Validation\xspace}
\newcommand{\summodels}{summarization models\xspace}
\newcommand{\Summodels}{Summarization models\xspace}
\newcommand{\methodology}{methodology\xspace}
\newcommand{\emethodology}{evaluation methodology\xspace}
\newcommand{\Methodology}{Methodology\xspace}
\newcommand{\methodologies}{methodologies\xspace}
\newcommand{\emethodologies}{evaluation methodologies\xspace}
\newcommand{\Methodologies}{Methodologies\xspace}
\newcommand{\bleu}{BLEU\xspace}
\newcommand{\xmatch}{exact match\xspace}
\newcommand{\precision}{precision\xspace}
\newcommand{\recall}{recall\xspace}
\newcommand{\fone}{F1\xspace}
\newcommand{\ipmode}{in-project\xspace}
\newcommand{\pmode}{cross-project\xspace}
\newcommand{\cmode}{continuous-mode\xspace}

\DefMacro{ds-train}{\Train\xspace}
\DefMacro{ds-val}{\Val\xspace}
\DefMacro{ds-test}{\Test\xspace}
\DefMacro{ds-all}{All\xspace}

\DefMacro{CG-DeepCom}{Hybrid-DeepCom\xspace}
\DefMacro{CG-Seq2seq}{Seq2seq\xspace}
\DefMacro{CG-Seq2seqAtt}{Seq2seqAtt\xspace}
\DefMacro{MN-Code2Seq}{Code2Seq\xspace}
\DefMacro{MN-Bi-LSTM}{BiLSTM\xspace}
\DefMacro{MN-no-split-Bi-LSTM}{BiLSTM(no-split)\xspace}

\def\checkmark{\tikz\fill[scale=0.25,color=black](0,.35) -- (.25,0) -- (1,.7) -- (.25,.15) -- cycle;}
\def\cross{$\mathbin{\tikz [x=1.4ex,y=1.4ex,line width=.2ex,color=black] \draw (0,0) -- (1,1) (0,1) -- (1,0);}$}
\newcommand{\mycheckmark}{{\normalsize \checkmark}\xspace}
\newcommand{\mycross}{$\mathbin{\tikz [x=1.4ex,y=1.4ex,line width=.2ex] \draw (0,0) -- (1,1) (0,1) -- (1,0);}$\xspace\xspace}

%%% Code
%\newcommand{\aVar}{\CodeIn{var}\xspace}

\newcommand{\aexamples}{\ensuremath{E}}
\newcommand{\atime}{\ensuremath{\tau}}
\newcommand{\atimep}{\ensuremath{\tau^{-1}}}
\newcommand{\atimepp}{\ensuremath{\tau^{-2}}}
\newcommand{\atimeppp}{\ensuremath{\tau^{-3}}}
\newcommand{\atrain}{\ensuremath{E_{train}}}
\newcommand{\aval}{\ensuremath{E_{val}}}
\newcommand{\atest}{\ensuremath{E_{test}}}
\newcommand{\aproject}{\ensuremath{p}}
\newcommand{\aprojecttrain}{\ensuremath{P_{train}}}
\newcommand{\aprojectval}{\ensuremath{P_{val}}}
\newcommand{\aprojecttest}{\ensuremath{P_{test}}}
\newcommand{\aprojects}{\ensuremath{P}}
\newcommand{\aextract}{\ensuremath{\mathsf{extract}}}
\newcommand{\ashuffle}{\ensuremath{\mathsf{shuffle}}}
\newcommand{\asplit}{\ensuremath{\mathsf{split}}}
\newcommand{\ajanone}{\ensuremath{\text{Jan }1^{st}}}

%%% Figures
\tikzset{dsTrain/.style={pattern=north west lines,preaction={fill=blue!80,fill opacity=0.2}}}
\tikzset{dsVal/.style={pattern=north east lines,preaction={fill=green!80,fill opacity=0.2}}}
\tikzset{dsTest/.style={pattern=crosshatch,preaction={fill=yellow!80,fill opacity=0.2}}}
\tikzset{sProject/.style={rounded box, minimum width=4em, minimum height=4em}}
\tikzset{sExample/.style={circle, minimum size=.8em, inner sep=0, draw=black}}
\newcommand{\wSepProject}{1em}


%%% Tables

% Captions & Spacing after table
%\newcommand{\TCXXX}{Lorem Ipsum Dolor Sit Amet, Consectetur Adipiscing Elit.\label{fig:table:xxx}}
%\newcommand{\TVXXX}{-0pt}
\newcommand{\TCModels}{Models for \ComGen. \label{table:models}}
\newcommand{\TVModels}{-0pt}

%% Captions for Comment Generation dataset
\newcommand{\TCDatasetMetricsMainCG}{
        \DataSet Statistics for the Entire Comment Generation \DataSet, Data Available at
        2020, and New Data between 2019 and
        2020.\label{table:dataset-cg-metrics-main}}
\newcommand{\TVDatasetMetricsMainCG}{-0pt}
\newcommand{\TCDatasetMetricsSplitCG}{
        \DataSet Statistics for the Comment Generation \Train, \Val, and \Test Sets
        of \Mixedproj, \Crossproj,
        and \Evoaware \Methodologies.\label{table:dataset-cg-metrics-split}}
\newcommand{\TVDatasetMetricsSplitCG}{-0pt}

%% Captions for Method Naming dataset
\newcommand{\TCDatasetMetricsMainMN}{
        \DataSet Statistics for the Entire Method Naming \DataSet, Data Available at
        2020, and New Data between 2019 and
        2020.\label{table:dataset-mn-metrics-main}}
\newcommand{\TVDatasetMetricsMainMN}{-0pt}
\newcommand{\TCDatasetMetricsSplitMN}{
        \DataSet Statistics for the Method Naming \Train, \Val, and \Test Sets
        of \Mixedproj, \Crossproj,
        and \Evoaware \Methodologies.\label{table:dataset-mn-metrics-split}}
\newcommand{\TVDatasetMetricsSplitMN}{-0pt}

\newcommand{\TCPriorWork}{\Methodologies Used in Prior Work. \label{table:prior-work}}
\newcommand{\TVPriorWork}{-0pt}

\newcommand{\TCEvalSettings}{Evaluation Settings. \label{table:eval-settings}}
\newcommand{\TVEvalSettings}{-0pt}

\newcommand{\TCResultsComGen}{
        Results for \ComGen.  The Results with the Same Superscripts
        are Not Statistically Significantly Different from Each Other
        ($p=0.95$ Using Wilcoxon Signed-rank
        Test~\cite{Wilcoxon45Individual}).\label{table:results-com-gen}}
\newcommand{\TVResultsComGen}{-0pt}
\newcommand{\TCResultsMethNam}{
        Results for \MethNam.  The Results with the Same Superscripts
        are Not Statistically Significantly Different from Each Other
        ($p=0.95$ Using Wilcoxon Signed-rank
        Test~\cite{Wilcoxon45Individual}). \label{table:results-meth-nam}}
\newcommand{\TVResultsMethNam}{-0pt}


% Headers
%\newcommand{\THXXX}{Yyy\xspace}
\newcommand{\THDataType}{\textbf{Set}\xspace}
\newcommand{\THNumProject}{\textbf{\#\Repo}\xspace}
\newcommand{\THNumDataEvolution}{\textbf{\Evo}\xspace}
\newcommand{\THNumDataLatest}{\textbf{\Lat}\xspace}
\newcommand{\THModel}{\textbf{Model}\xspace}
\newcommand{\THDSStat}{\textbf{Statistic}\xspace}

\DefMacro{TH-model-DeepCom}{\UseMacro{CG-DeepCom}\xspace}
\DefMacro{TH-model-Seq2seq}{\UseMacro{CG-Seq2seq}\xspace}
\DefMacro{TH-model-Seq2seqAtt}{\UseMacro{CG-Seq2seqAtt}\xspace}

\DefMacro{TH-model-Bi-LSTM}{\UseMacro{MN-Bi-LSTM}\xspace}
\DefMacro{TH-model-Code2Seq}{\UseMacro{MN-Code2Seq}\xspace}
\DefMacro{TH-model-no-split-Bi-LSTM}{\UseMacro{MN-no-split-Bi-LSTM}\xspace}

\DefMacro{TH-metric-bleu}{\textbf{\bleu}\xspace}
\DefMacro{TH-metric-xmatch}{\textbf{xMatch}\xspace}
\DefMacro{TH-metric-f1}{\textbf{F1}\xspace}
\DefMacro{TH-metric-precision}{\textbf{Prec}\xspace}
\DefMacro{TH-metric-recall}{\textbf{Rec}\xspace}

\DefMacro{TH-exp-crossproj-2020}{\textbf{\Crossproj}\xspace}
\DefMacro{TH-exp-mixedproj-2020}{\textbf{\Mixedproj}\xspace}
\DefMacro{TH-exp-evo-2020}{\textbf{\Evoaware}\xspace}

\DefMacro{TH-ds-all}{\textbf{All}\xspace}
\DefMacro{TH-ds-2020}{\textbf{2020}\xspace}
\DefMacro{TH-ds-2019-2020}{\textbf{\makecell{2019-\\2020}}\xspace}
\DefMacro{TH-ds-mixedproj}{\textbf{\Mixedproj}\xspace}
\DefMacro{TH-ds-mixedproj-train}{\textbf{\Train}\xspace}
\DefMacro{TH-ds-mixedproj-val}{\textbf{\Val}\xspace}
\DefMacro{TH-ds-crossproj}{\textbf{\Crossproj}\xspace}
\DefMacro{TH-ds-crossproj-train}{\textbf{\Train}\xspace}
\DefMacro{TH-ds-crossproj-val}{\textbf{\Val}\xspace}
\DefMacro{TH-ds-evo}{\textbf{\Evoaware}\xspace}
\DefMacro{TH-ds-evo-train}{\textbf{\Train}\xspace}
\DefMacro{TH-ds-evo-val}{\textbf{\Val}\xspace}
\DefMacro{TH-ds-test}{\textbf{\Test}\xspace}
\DefMacro{TH-ds-num-project}{\textbf{\#Proj}\xspace}
\DefMacro{TH-ds-num-data}{\textbf{\#Meth}\xspace}
\DefMacro{TH-ds-len-method}{\textbf{len(Meth)}\xspace}
\DefMacro{TH-ds-len-method-avg}{avg\xspace}
\DefMacro{TH-ds-len-method-mode}{mode\xspace}
\DefMacro{TH-ds-len-method-median}{median\xspace}
\DefMacro{TH-ds-len-method-le100}{$\le$100\xspace}
\DefMacro{TH-ds-len-method-le150}{$\le$150\xspace}
\DefMacro{TH-ds-len-method-le200}{$\le$200\xspace}
\DefMacro{TH-ds-len-comment}{\textbf{len(Com)}\xspace}
\DefMacro{TH-ds-len-comment-avg}{avg\xspace}
\DefMacro{TH-ds-len-comment-mode}{mode\xspace}
\DefMacro{TH-ds-len-comment-median}{median\xspace}
\DefMacro{TH-ds-len-comment-le20}{$\le$20\xspace}
\DefMacro{TH-ds-len-comment-le30}{$\le$30\xspace}
\DefMacro{TH-ds-len-comment-le50}{$\le$50\xspace}
\DefMacro{TH-ds-len-name}{\textbf{len(Name)}\xspace}
\DefMacro{TH-ds-len-name-avg}{avg\xspace}
\DefMacro{TH-ds-len-name-mode}{mode\xspace}
\DefMacro{TH-ds-len-name-median}{median\xspace}
\DefMacro{TH-ds-len-name-le2}{$\le$2\xspace}
\DefMacro{TH-ds-len-name-le3}{$\le$3\xspace}
\DefMacro{TH-ds-len-name-le6}{$\le$6\xspace}

%%% Numbers

%\input{tables/numbers-xxx}
\input{tables/numbers-CG-dataset-metrics}
\input{tables/numbers-MN-dataset-metrics}
%% \input{tables/numbers-time-wise-dataset-metrics}
%% \input{tables/numbers-time-wise-dataset-metrics}
%% \input{tables/numbers-time-wise-filtered-dataset-metrics}
%% \input{tables/numbers-deepcom-results}
%% \input{tables/numbers-deepcom-sbt-results}
%% \input{tables/numbers-deepcom-preorder-results}
%% \input{tables/numbers-seq2seq-results}
%% \input{tables/numbers-seq2seqatt-results}
%% \input{tables/numbers-time-wise-large-dataset-metrics}
%% \input{tables/numbers-time-wise-filtered-large-dataset-metrics}
%% \input{tables/numbers-time-wise-beta-filtered-debug-dataset-metrics}
%% \input{tables/numbers-code2seq-debug-results}
%% \input{tables/numbers-code2seq-lat-results}
%% \input{tables/numbers-code2seq-evo-results}
%% \input{tables/numbers-bi-lstm-lat-results}
%% \input{tables/numbers-bi-lstm-evo-results}
%% \input{tables/numbers-no-split-bi-lstm-evo-results}
%% \input{tables/numbers-no-split-bi-lstm-lat-results}


%% \input{tables/numbers-deepcom-lat-results}
%% \input{tables/numbers-deepcom-evo-results}
%% \input{tables/numbers-deepcom-sbt-lat-results}
%% \input{tables/numbers-deepcom-sbt-evo-results}
%% \input{tables/numbers-seq2seq-lat-results}
%% \input{tables/numbers-seq2seq-evo-results}
%% \input{tables/numbers-seq2seqatt-lat-results}
%% \input{tables/numbers-seq2seqatt-evo-results}

\input{tables/numbers-Bi-LSTM-results}
\input{tables/numbers-Code2Seq-results}
\input{tables/numbers-no-split-Bi-LSTM-results}
%% \input{tables/numbers-code2seq-cross-proj-latest-results}
%% \input{tables/numbers-no-split-bi-lstm-cross-proj-latest-results}
\input{tables/numbers-DeepCom-results}
\input{tables/numbers-Seq2seq-results}
\input{tables/numbers-Seq2seqAtt-results}

%% \input{tables/numbers-beta-filtered-method-avg-len}

%\newcommand{\NumXXX}{42\xspace}
\newcommand{\NumProjectPlanned}{1,000\xspace}
\newcommand{\NumProject}{\UseMacro{ds-num-proj}\xspace}
\newcommand{\NumRevisionAll}{\UseMacro{ds-num-year}\xspace}
\newcommand{\NumDataAll}{\UseMacro{raw-ds-num-data_all}\xspace}
\newcommand{\NumDataLatest}{\UseMacro{ds-num-data_2020}\xspace}
\newcommand{\NumTrial}{three\xspace}
