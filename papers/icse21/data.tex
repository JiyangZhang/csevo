\section{Dataset}
\label{sec:data}

This section describes the dataset we collected to facilitate our
experiments.  We collected our dataset as mappings between code and
natural language elements from large and popular evolving projects.
For our tasks, we extract methods (as code elements) and method names
and \javadoc comments as natural language elements.  In our study, we
chose to use only projects written in the Java programming language,
because \Fix{most/all} prior work focused on this language.  We also
focus only on comments that are written in English to be consistent
with prior work.  In the future, it would be worth studying other
programming and natural languages.

%The code is Java methods, and the natural language elements are the
%names and \javadoc comments of those methods.

We started with the \NumProjectPlanned Java projects on GitHub that
have the most stars (i.e., most number of users who liked the
projects).  This approach was used in \Fix{most} recent related work.
We then discarded the projects where no valid data could be collected
(e.g., no method \javadoc) or are obviously not software projects
(e.g.,
\href{https://github.com/CyC2018/CS-Notes}{CyC2018/CS-Notes}). After
this filtering, we ended up with \NumProject projects.  For each
project, we then performed the following steps:
\begin{enumerate}
\item clone the project;
\item checkout revisions on \ajanone{} of each year from 2017 to 2020;
\item at each revision, find all \CodeIn{*.java} files and use
  JavaParser~\cite{JavaParser} to parse the files;
\item collect all method bodies (removing inline comments from them)
  and their \javadoc, but discarding the data that matches any of the
  following conditions: (a) the method is abstract; (b) the \javadoc
  summary is empty; (c) the method body or the \javadoc summary
  contains non-English characters; (d) the method body is longer than
  10,000 characters.\Fix{how many for each}
\end{enumerate}

The final dataset consists of \NumDataAll unique method-\javadoc pairs
across all \NumRevisionAll revisions (\NumDataLatest from the latest
revision at \ajanone{}, 2020).

We implement the \filterfunc $F(d_1, d_2)$ to keep only the new
methods in $d_2$ that do not exist in $d_1$, by removing the method
that has the same tuple of class name, method name, and method
arguments:
\begin{flalign*}
  &F(d_1, d_2) = \{ m | m \in d_2 \land \lqall{m' \in d_1} \\
  &\qquad (\mathtt{ClassName}(m), \mathtt{Name}(m), \mathtt{Arguments}(m)) \neq \\
  &\qquad\qquad (\mathtt{ClassName}(m'), \mathtt{Name}(m'), \mathtt{Arguments}(m'))\}
\end{flalign*}

\input{tables/table-CG-dataset-metrics-main}
\input{tables/table-MN-dataset-metrics-main}
\input{tables/table-CG-dataset-metrics-split}
\input{tables/table-MN-dataset-metrics-split}

Table~\ref{table:dataset-metrics-main} and
Table~\ref{table:dataset-metrics-split} shows the statistics of
various parts of the dataset.
%
The statistics include (from the top row to the bottom row): number of
projects\Fix{same?}, number of methods, the \{average, mode, median\}
length (number of tokens) of method bodies, the percentage of methods
whose bodies length $\le$ \{100, 150, 200\}, the \{average, mode,
median\} length (number of tokens) of comments, the percentage of
methods whose comments length $\le$ \{20, 30, 50\}, the \{average,
mode, median\} length (number of sub-tokens) of method names, the
percentage of methods whose names length $\le$ \{2, 3, 6\}.
Table~\ref{table:dataset-metrics-main} lists the statistics for the
entire dataset, data available at 2020 ($\mathcal{D}(\mathcal{P},
2020)$), and new data between 2019 and 2020 ($\mathcal{D}(\mathcal{P},
2019, 2020)$); and Table~\ref{table:dataset-metrics-split} lists the
statistics for the \{\train, \val{}\} sets for the \mixedproj
\methodology, the \{\train, \val{}\} sets for the \crossproj
\methodology, the \{\train, \val{}\} sets for the \evoaware
\methodology, and the \test set which is common to all \methodologies.

\begin{figure}[t]
  \centering
  \includegraphics[width=.9\columnwidth]{figs/num-data-evolution.eps}
  \caption{Number of methods on each revision and new to each revision. \label{fig:num-data-evolution}}
\end{figure}

Figure~\ref{fig:num-data-evolution} shows the bar plots of the number
of methods on each revision of the \dataset, as well as the number of
methods new to each revision of the \dataset.  Figure~\ref{X} shows
the bar plots of the average length of methods, comments, and names on
each revision of the \dataset.
